<template>
<!-- eslint-disable -->
<div class="v-docs">
<div class="markdown-body"><h4>7、部分重要功能代码</h4>
<hr>
<h5>页面编辑区</h5>
<blockquote>
<p>编辑器以 vue 动态组件 component 遍历铺排实现而成</p>
</blockquote>
<pre class="hljs language language-html" data-lang="html"><code v-html="'&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;NjElementBox&lt;/span&gt;\n    &lt;span class=&quot;hljs-attr&quot;&gt;v-for&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;(item, index) in curPageData.elements&quot;&lt;/span&gt;\n    &lt;span class=&quot;hljs-attr&quot;&gt;:id&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;item.uuid&quot;&lt;/span&gt;\n    &lt;span class=&quot;hljs-attr&quot;&gt;:key&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;item.uuid&quot;&lt;/span&gt;\n    &lt;span class=&quot;hljs-attr&quot;&gt;:style&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;item.styleInfo&quot;&lt;/span&gt;\n    &lt;span class=&quot;hljs-attr&quot;&gt;:style-info.sync&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;item.styleInfo&quot;&lt;/span&gt;\n    &lt;span class=&quot;hljs-attr&quot;&gt;:component-resizing.sync&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;componentResizing&quot;&lt;/span&gt;\n    &lt;span class=&quot;hljs-attr&quot;&gt;:target-id&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;item.uuid&quot;&lt;/span&gt;\n    &lt;span class=&quot;hljs-attr&quot;&gt;:class&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;[\n        {\'active\': item.uuid === editingComponent.uuid},\n        item.animate,\n        \'animated\',\n        {\'move\': !componentResizing}\n    ]&quot;&lt;/span&gt;\n    @&lt;span class=&quot;hljs-attr&quot;&gt;click.native&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;setEditingComponent(item)&quot;&lt;/span&gt;\n    @&lt;span class=&quot;hljs-attr&quot;&gt;deleteElement&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;deleteElement(index)&quot;&lt;/span&gt;\n    @&lt;span class=&quot;hljs-attr&quot;&gt;updateEditingStyleInfo&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;updateEditingStyleInfo&quot;&lt;/span&gt;\n&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;component&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;:is&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;item.name&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;nj-element&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;:item&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;item&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;NjElementBox&lt;/span&gt;&amp;gt;&lt;/span&gt;\n'"></code></pre>
<h5>组件宽高快捷缩放</h5>
<blockquote>
<p>主要利用 mousedown 及 mousemove 事件的监听，获取鼠标实时位置，计算移动轨迹从而改变组件的宽高属性</p>
</blockquote>
<pre class="hljs language language-html" data-lang="html"><code v-html="'&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;div&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;nj-element-box&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;slot&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;slot&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;lt&quot;&lt;/span&gt; @&lt;span class=&quot;hljs-attr&quot;&gt;mousedown&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;(e) =&amp;gt; { handlerMousedown(e, \'lt\')}&quot;&lt;/span&gt; @&lt;span class=&quot;hljs-attr&quot;&gt;mouseout&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;resetFlag&quot;&lt;/span&gt; @&lt;span class=&quot;hljs-attr&quot;&gt;mouseover&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;setFlag&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;i&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;lm&quot;&lt;/span&gt; @&lt;span class=&quot;hljs-attr&quot;&gt;mousedown&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;(e) =&amp;gt; { handlerMousedown(e, \'lm\')}&quot;&lt;/span&gt; @&lt;span class=&quot;hljs-attr&quot;&gt;mouseout&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;resetFlag&quot;&lt;/span&gt; @&lt;span class=&quot;hljs-attr&quot;&gt;mouseover&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;setFlag&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;i&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;lb&quot;&lt;/span&gt; @&lt;span class=&quot;hljs-attr&quot;&gt;mousedown&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;(e) =&amp;gt; { handlerMousedown(e, \'lb\')}&quot;&lt;/span&gt; @&lt;span class=&quot;hljs-attr&quot;&gt;mouseout&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;resetFlag&quot;&lt;/span&gt; @&lt;span class=&quot;hljs-attr&quot;&gt;mouseover&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;setFlag&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;i&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;rt&quot;&lt;/span&gt; @&lt;span class=&quot;hljs-attr&quot;&gt;mousedown&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;(e) =&amp;gt; { handlerMousedown(e, \'rt\')}&quot;&lt;/span&gt; @&lt;span class=&quot;hljs-attr&quot;&gt;mouseout&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;resetFlag&quot;&lt;/span&gt; @&lt;span class=&quot;hljs-attr&quot;&gt;mouseover&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;setFlag&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;i&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;rm&quot;&lt;/span&gt; @&lt;span class=&quot;hljs-attr&quot;&gt;mousedown&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;(e) =&amp;gt; { handlerMousedown(e, \'rm\')}&quot;&lt;/span&gt; @&lt;span class=&quot;hljs-attr&quot;&gt;mouseout&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;resetFlag&quot;&lt;/span&gt; @&lt;span class=&quot;hljs-attr&quot;&gt;mouseover&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;setFlag&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;i&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;rb&quot;&lt;/span&gt; @&lt;span class=&quot;hljs-attr&quot;&gt;mousedown&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;(e) =&amp;gt; { handlerMousedown(e, \'rb\')}&quot;&lt;/span&gt; @&lt;span class=&quot;hljs-attr&quot;&gt;mouseout&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;resetFlag&quot;&lt;/span&gt; @&lt;span class=&quot;hljs-attr&quot;&gt;mouseover&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;setFlag&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;i&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;mt&quot;&lt;/span&gt; @&lt;span class=&quot;hljs-attr&quot;&gt;mousedown&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;(e) =&amp;gt; { handlerMousedown(e, \'mt\')}&quot;&lt;/span&gt; @&lt;span class=&quot;hljs-attr&quot;&gt;mouseout&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;resetFlag&quot;&lt;/span&gt; @&lt;span class=&quot;hljs-attr&quot;&gt;mouseover&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;setFlag&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;i&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;mb&quot;&lt;/span&gt; @&lt;span class=&quot;hljs-attr&quot;&gt;mousedown&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;(e) =&amp;gt; { handlerMousedown(e, \'mb\')}&quot;&lt;/span&gt; @&lt;span class=&quot;hljs-attr&quot;&gt;mouseout&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;resetFlag&quot;&lt;/span&gt; @&lt;span class=&quot;hljs-attr&quot;&gt;mouseover&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;setFlag&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;i&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;span&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;mask&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;span&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;\n'"></code></pre>
<pre class="hljs language language-js" data-lang="js"><code v-html="'handlerMousedown(ev, type) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; startX = ev.x;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; startY = ev.y;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; targetEl = &lt;span class=&quot;hljs-built_in&quot;&gt;document&lt;/span&gt;.getElementById(&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.targetId);\n    &lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; originW = targetEl.offsetWidth;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; originH = targetEl.offsetHeight;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; leftToPar = (!&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.styleInfo[&lt;span class=&quot;hljs-string&quot;&gt;&quot;margin-left&quot;&lt;/span&gt;] || &lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.styleInfo[&lt;span class=&quot;hljs-string&quot;&gt;&quot;margin-left&quot;&lt;/span&gt;] === &lt;span class=&quot;hljs-string&quot;&gt;&quot;auto&quot;&lt;/span&gt;) ? &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt; : (+(&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.styleInfo[&lt;span class=&quot;hljs-string&quot;&gt;&quot;margin-left&quot;&lt;/span&gt;].replace(&lt;span class=&quot;hljs-string&quot;&gt;&quot;px&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;).replace(&lt;span class=&quot;hljs-string&quot;&gt;&quot;%&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-string&quot;&gt;&quot;&quot;&lt;/span&gt;)) || &lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;);\n    &lt;span class=&quot;hljs-built_in&quot;&gt;document&lt;/span&gt;.onmousemove = &lt;span class=&quot;hljs-function&quot;&gt;(&lt;span class=&quot;hljs-params&quot;&gt;e&lt;/span&gt;) =&amp;gt;&lt;/span&gt; {\n        e.preventDefault();\n        _throttleHandler(&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; =&amp;gt;&lt;/span&gt; {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.resizeFun({ e, type, startX, startY, originW, originH, leftToPar });\n        });\n    };\n    &lt;span class=&quot;hljs-built_in&quot;&gt;document&lt;/span&gt;.onmouseup = &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; =&amp;gt;&lt;/span&gt; {\n        &lt;span class=&quot;hljs-built_in&quot;&gt;document&lt;/span&gt;.onmousemove = &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\n        &lt;span class=&quot;hljs-built_in&quot;&gt;document&lt;/span&gt;.onmouseup = &lt;span class=&quot;hljs-literal&quot;&gt;null&lt;/span&gt;;\n    };\n},\nresizeFun({ e, type, startX, startY, originW, originH, leftToPar }) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;let&lt;/span&gt; targetW, targetH;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; moveX = e.x - startX;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; moveY = e.y - startY;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;switch&lt;/span&gt; (type) {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;lt&quot;&lt;/span&gt;:\n            targetW = originW - moveX;\n            targetH = originH - moveY;\n            &lt;span class=&quot;hljs-keyword&quot;&gt;break&lt;/span&gt;;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;lb&quot;&lt;/span&gt;:\n            targetW = originW - moveX;\n            targetH = originH + moveY;\n            &lt;span class=&quot;hljs-keyword&quot;&gt;break&lt;/span&gt;;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;rt&quot;&lt;/span&gt;:\n            targetW = originW + moveX;\n            targetH = originH - moveY;\n            &lt;span class=&quot;hljs-keyword&quot;&gt;break&lt;/span&gt;;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;rb&quot;&lt;/span&gt;:\n            targetW = originW + moveX;\n            targetH = originH + moveY;\n            &lt;span class=&quot;hljs-keyword&quot;&gt;break&lt;/span&gt;;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;lm&quot;&lt;/span&gt;:\n            targetW = originW - moveX;\n            targetH = originH;\n            &lt;span class=&quot;hljs-keyword&quot;&gt;break&lt;/span&gt;;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;rm&quot;&lt;/span&gt;:\n            targetW = originW + moveX;\n            targetH = originH;\n            &lt;span class=&quot;hljs-keyword&quot;&gt;break&lt;/span&gt;;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;mt&quot;&lt;/span&gt;:\n            targetW = originW;\n            targetH = originH - moveY;\n            &lt;span class=&quot;hljs-keyword&quot;&gt;break&lt;/span&gt;;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;mb&quot;&lt;/span&gt;:\n            targetW = originW;\n            targetH = originH + moveY;\n            &lt;span class=&quot;hljs-keyword&quot;&gt;break&lt;/span&gt;;\n    }\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (leftToPar + targetW &amp;gt; &lt;span class=&quot;hljs-number&quot;&gt;375&lt;/span&gt;) {\n        targetW = &lt;span class=&quot;hljs-number&quot;&gt;375&lt;/span&gt;;\n    }\n    &lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; styleInfo = &lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.styleInfo;\n    styleInfo.width = targetW + &lt;span class=&quot;hljs-string&quot;&gt;&quot;px&quot;&lt;/span&gt;;\n    styleInfo.height = targetH + &lt;span class=&quot;hljs-string&quot;&gt;&quot;px&quot;&lt;/span&gt;;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.$emit(&lt;span class=&quot;hljs-string&quot;&gt;&quot;update:styleInfo&quot;&lt;/span&gt;, styleInfo);\n    &lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.$emit(&lt;span class=&quot;hljs-string&quot;&gt;&quot;updateEditingComponent&quot;&lt;/span&gt;, styleInfo);\n}\n'"></code></pre>
<h5>组件列表区到页面编辑区拖拽功能</h5>
<blockquote>
<p>主要利用h5原生drag属性，e.dataTransfer 的 setData 和 getData 方法用来值传递组件 code，再从通用配置中查找对应组件数据填入，最终达到组件拖拽的效果</p>
</blockquote>
<pre class="hljs language language-html" data-lang="html"><code v-html="'// 源：组件列表展示区\n&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;ul&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;element-list&quot;&lt;/span&gt; @&lt;span class=&quot;hljs-attr&quot;&gt;dragstart&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;handleDragStart&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;li&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;v-for&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;(value, key) in configList&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;:key&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;key&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;element-item&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;draggable&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;:data-index&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;key&quot;&lt;/span&gt;\n    &amp;gt;&lt;/span&gt;\n        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;p&lt;/span&gt;&amp;gt;&lt;/span&gt;\n            &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;iconfont&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;:class&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;value.icon&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;i&lt;/span&gt;&amp;gt;&lt;/span&gt;\n        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;p&lt;/span&gt;&amp;gt;&lt;/span&gt;\n        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;p&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;mini&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;{{ value.desc }}&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;p&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;li&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;ul&lt;/span&gt;&amp;gt;&lt;/span&gt;\n'"></code></pre>
<pre class="hljs language language-js" data-lang="js"><code v-html="'handleDragStart(e) {\n    e.dataTransfer.setData(&lt;span class=&quot;hljs-string&quot;&gt;&quot;index&quot;&lt;/span&gt;, e.target.dataset.index);\n}\n'"></code></pre>
<pre class="hljs language language-html" data-lang="html"><code v-html="'// 目标\n&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;div&lt;/span&gt;\n    &lt;span class=&quot;hljs-attr&quot;&gt;id&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;mobileView&quot;&lt;/span&gt;\n    &lt;span class=&quot;hljs-attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;mobile-view&quot;&lt;/span&gt;\n    &lt;span class=&quot;hljs-attr&quot;&gt;:style&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;pageStyle&quot;&lt;/span&gt;\n    &lt;span class=&quot;hljs-attr&quot;&gt;:draggable&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;false&quot;&lt;/span&gt;\n    @&lt;span class=&quot;hljs-attr&quot;&gt;drop&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;handleDrop&quot;&lt;/span&gt;\n    @&lt;span class=&quot;hljs-attr&quot;&gt;dragover&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;handleDragOver&quot;&lt;/span&gt;\n&amp;gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;div&lt;/span&gt;&amp;gt;&lt;/span&gt;\n'"></code></pre>
<pre class="hljs language language-js" data-lang="js"><code v-html="'handleDragOver(e) {\n    e.preventDefault();\n},\nhandleDrop(e) {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; key = e.dataTransfer.getData(&lt;span class=&quot;hljs-string&quot;&gt;&quot;index&quot;&lt;/span&gt;);\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (!key) &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt;;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; item = deepClone(&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.configList[key]);\n    item.uuid = uuidv4();\n    &lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; curPageData = &lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.curPageData;\n    item.configCode = key;\n    curPageData.elements.push(item);\n},\n'"></code></pre>
<h5>页面编辑区内拖拽</h5>
<blockquote>
<p>使用 vuedraggable 组件实现</p>
</blockquote>
<pre class="hljs language language-html" data-lang="html"><code v-html="'&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;Draggable&lt;/span&gt;\n    &lt;span class=&quot;hljs-attr&quot;&gt;v-model&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;curPageData.elements&quot;&lt;/span&gt;\n    &lt;span class=&quot;hljs-attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;dragger-box&quot;&lt;/span&gt;\n    &lt;span class=&quot;hljs-attr&quot;&gt;handle&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;.move&quot;&lt;/span&gt;\n    &lt;span class=&quot;hljs-attr&quot;&gt;filter&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;.unmove&quot;&lt;/span&gt;\n    &lt;span class=&quot;hljs-attr&quot;&gt;:animation&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;400&quot;&lt;/span&gt;\n&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;NjElementBox&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;v-for&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;item in curPageData.elements&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;:id&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;item.uuid&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;:key&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;item.uuid&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;:style&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;item.styleInfo&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;:style-info.sync&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;item.styleInfo&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;:target-id&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;item.uuid&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;:component-resizing.sync&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;componentResizing&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;:class&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;[\n            {\'active\': item.uuid === editingComponent.uuid},\n            item.animate,\n            \'animated\',\n            {\'move\': !componentResizing}\n        ]&quot;&lt;/span&gt;\n        @&lt;span class=&quot;hljs-attr&quot;&gt;click.native&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;setEditingComponent(item)&quot;&lt;/span&gt;\n        @&lt;span class=&quot;hljs-attr&quot;&gt;updateEditingComponent&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;updateEditingComponent&quot;&lt;/span&gt;\n    &amp;gt;&lt;/span&gt;\n        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;component&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;:is&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;item.name&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;nj-element&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;:item&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;item&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;NjElementBox&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;Draggable&lt;/span&gt;&amp;gt;&lt;/span&gt;\n'"></code></pre>
<h5>组件配置动态表单</h5>
<pre class="hljs language language-html" data-lang="html"><code v-html="'&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;el-form-item&lt;/span&gt;\n    &lt;span class=&quot;hljs-attr&quot;&gt;v-if&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;!item.when || item.when(editingComponent.configMap)&quot;&lt;/span&gt;\n    &lt;span class=&quot;hljs-attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;right-form-item&quot;&lt;/span&gt;\n    &lt;span class=&quot;hljs-attr&quot;&gt;:label&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;item.label&quot;&lt;/span&gt;\n&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;el-input&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;v-if&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;item.formType === \'input\'&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;v-model&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;item.value&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;v-setDisableKeycode&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;:placeholder&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;item.placeholder&quot;&lt;/span&gt;\n    /&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;el-input&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;v-if&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;item.formType === \'textarea\'&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;v-model&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;item.value&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;v-setDisableKeycode&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;:autosize&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;{ minRows: 2, maxRows: 8}&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;:placeholder&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;item.placeholder&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;type&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;textarea&quot;&lt;/span&gt;\n    /&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;el-select&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;v-if&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;item.formType === \'select\'&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;v-model&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;item.value&quot;&lt;/span&gt;\n    &amp;gt;&lt;/span&gt;\n        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;el-option&lt;/span&gt;\n            &lt;span class=&quot;hljs-attr&quot;&gt;v-for&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;i in item.valueMap&quot;&lt;/span&gt;\n            &lt;span class=&quot;hljs-attr&quot;&gt;:key&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;i.value&quot;&lt;/span&gt;\n            &lt;span class=&quot;hljs-attr&quot;&gt;:label&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;i.desc&quot;&lt;/span&gt;\n            &lt;span class=&quot;hljs-attr&quot;&gt;:value&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;i.value&quot;&lt;/span&gt;\n        /&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;el-select&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;el-upload&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;v-if&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;item.formType === \'upload\'&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;action&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;/&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;avatar-uploader&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;:show-file-list&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;false&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;:on-success&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;(res, file) =&amp;gt; { handleSuccess(res, file, item) }&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;:before-upload&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;(file) =&amp;gt; { beforeUpload(file, item) }&quot;&lt;/span&gt;\n    &amp;gt;&lt;/span&gt;\n        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;img&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;v-if&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;item.value&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;:src&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;item.value&quot;&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;avatar&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;\n        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;v-else&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;el-icon-plus avatar-uploader-icon&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;i&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;el-upload&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;el-tooltip&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;v-if&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;item.formType !== \'upload\' &amp;amp;&amp;amp; item.tip&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;effect&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;dark&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;:content&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;item.tip&quot;&lt;/span&gt;\n        &lt;span class=&quot;hljs-attr&quot;&gt;placement&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;top&quot;&lt;/span&gt;\n    &amp;gt;&lt;/span&gt;\n        &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;&lt;span class=&quot;hljs-name&quot;&gt;i&lt;/span&gt; &lt;span class=&quot;hljs-attr&quot;&gt;class&lt;/span&gt;=&lt;span class=&quot;hljs-string&quot;&gt;&quot;el-icon-info&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;i&lt;/span&gt;&amp;gt;&lt;/span&gt;\n    &lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;el-tooltip&lt;/span&gt;&amp;gt;&lt;/span&gt;\n&lt;span class=&quot;hljs-tag&quot;&gt;&amp;lt;/&lt;span class=&quot;hljs-name&quot;&gt;el-form-item&lt;/span&gt;&amp;gt;&lt;/span&gt;\n'"></code></pre>
<h5>组件事件注册处理</h5>
<pre class="hljs language language-js" data-lang="js"><code v-html="'&lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; handlerEvent = &lt;span class=&quot;hljs-keyword&quot;&gt;async&lt;/span&gt; (eventInfo) =&amp;gt; {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; el = &lt;span class=&quot;hljs-built_in&quot;&gt;document&lt;/span&gt;.getElementById(eventInfo.uuid);\n    &lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; hammer = &lt;span class=&quot;hljs-keyword&quot;&gt;new&lt;/span&gt; Hammer(el);\n    &lt;span class=&quot;hljs-keyword&quot;&gt;let&lt;/span&gt; actionHandler = &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; =&amp;gt;&lt;/span&gt; {};\n    &lt;span class=&quot;hljs-keyword&quot;&gt;switch&lt;/span&gt; (eventInfo.action) {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;toast&quot;&lt;/span&gt;:\n            actionHandler = &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; =&amp;gt;&lt;/span&gt; {\n                &lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; text = eventInfo.text;\n                &lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; time = eventInfo.time;\n                toastTip({\n                    text,\n                    time\n                });\n            };\n            &lt;span class=&quot;hljs-keyword&quot;&gt;break&lt;/span&gt;;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;jumpLink&quot;&lt;/span&gt;:\n            actionHandler = &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; =&amp;gt;&lt;/span&gt; {\n                &lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; url = eventInfo.url;\n                location.href = url;\n            };\n            &lt;span class=&quot;hljs-keyword&quot;&gt;break&lt;/span&gt;;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;jumpPage&quot;&lt;/span&gt;:\n            actionHandler = &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; =&amp;gt;&lt;/span&gt; {\n                &lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; urlParams = getUrlParams();\n                &lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; pageId = eventInfo.targetUuid;\n                &lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; resParams = {\n                    ...urlParams,\n                    pageId\n                };\n                &lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; url = urlWithObj(&lt;span class=&quot;hljs-string&quot;&gt;`&lt;span class=&quot;hljs-subst&quot;&gt;${location.origin}&lt;/span&gt;/view`&lt;/span&gt;, resParams);\n                location.href = url;\n            };\n            &lt;span class=&quot;hljs-keyword&quot;&gt;break&lt;/span&gt;;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;runCode&quot;&lt;/span&gt;:\n            actionHandler = &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; =&amp;gt;&lt;/span&gt; {\n                &lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; code = eventInfo.jsCode;\n                runJsCode(code);\n            };\n            &lt;span class=&quot;hljs-keyword&quot;&gt;break&lt;/span&gt;;\n    }\n    &lt;span class=&quot;hljs-keyword&quot;&gt;switch&lt;/span&gt; (eventInfo.trigger) {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;click&quot;&lt;/span&gt;:\n            el.addEventListener(&lt;span class=&quot;hljs-string&quot;&gt;&quot;click&quot;&lt;/span&gt;, actionHandler);\n            &lt;span class=&quot;hljs-keyword&quot;&gt;break&lt;/span&gt;;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;load&quot;&lt;/span&gt;:\n            actionHandler();\n            &lt;span class=&quot;hljs-keyword&quot;&gt;break&lt;/span&gt;;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;longPress&quot;&lt;/span&gt;:\n            hammer.on(&lt;span class=&quot;hljs-string&quot;&gt;&quot;press&quot;&lt;/span&gt;, () =&amp;gt; {\n                actionHandler();\n            });\n            &lt;span class=&quot;hljs-keyword&quot;&gt;break&lt;/span&gt;;\n    }\n};\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; handlerEventData = &lt;span class=&quot;hljs-function&quot;&gt;(&lt;span class=&quot;hljs-params&quot;&gt;curPageData&lt;/span&gt;) =&amp;gt;&lt;/span&gt; {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; elements = curPageData.elements;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; { events, uuid } &lt;span class=&quot;hljs-keyword&quot;&gt;of&lt;/span&gt; elements) {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (events &amp;amp;&amp;amp; events.length) {\n            &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; { trigger, action, configMap } &lt;span class=&quot;hljs-keyword&quot;&gt;of&lt;/span&gt; events) {\n                &lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; filterInfo = {\n                    trigger,\n                    action,\n                    uuid\n                };\n                &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; k &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; configMap) {\n                    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (!configMap[k].when || configMap[k].when(action)) {\n                        filterInfo[configMap[k].key] = configMap[k].value;\n                    }\n                }\n                handlerEvent(filterInfo);\n            }\n        }\n    }\n};\n\n&lt;span class=&quot;hljs-keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;hljs-keyword&quot;&gt;default&lt;/span&gt; handlerEventData;\n'"></code></pre>
<h5>组件数据加工车间</h5>
<pre class="hljs language language-js" data-lang="js"><code v-html="'&lt;span class=&quot;hljs-comment&quot;&gt;/**\n * &lt;span class=&quot;hljs-doctag&quot;&gt;@description &lt;/span&gt;为数据增添表单项供平台使用\n * &lt;span class=&quot;hljs-doctag&quot;&gt;@param &lt;span class=&quot;hljs-type&quot;&gt;{*}&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;activityData&lt;/span&gt;&lt;/span&gt;\n * &lt;span class=&quot;hljs-doctag&quot;&gt;@returns&lt;/span&gt;\n */&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;setConfigMap&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;activityData&lt;/span&gt;) &lt;/span&gt;{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (!activityData || !activityData.pages || !activityData.pages.length) &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; activityData;\n    activityData.pages.forEach(&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-params&quot;&gt;i&lt;/span&gt; =&amp;gt;&lt;/span&gt; {\n        i.elements &amp;amp;&amp;amp; i.elements.length &amp;amp;&amp;amp; i.elements.forEach(&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-params&quot;&gt;j&lt;/span&gt; =&amp;gt;&lt;/span&gt; {\n            &lt;span class=&quot;hljs-comment&quot;&gt;// 组件基础配置处理&lt;/span&gt;\n            &lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; midMap = deepClone(configList[j.configCode].configMap);\n            &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; k &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; j.configInfo) {\n                midMap[k].value = j.configInfo[k];\n            }\n            j.configMap = midMap;\n            j.configInfo &amp;amp;&amp;amp; &lt;span class=&quot;hljs-keyword&quot;&gt;delete&lt;/span&gt; j.configInfo;\n\n            &lt;span class=&quot;hljs-comment&quot;&gt;// 组件样式配置处理&lt;/span&gt;\n            &lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; styleMap = {};\n            &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; k &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; j.styleInfo) {\n                &lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; curMap = deepClone(commonStyleConfigMap[k]);\n                styleMap[k] = curMap;\n                styleMap[k].value = j.styleInfo[k];\n            }\n            j.styleMap = styleMap;\n            &lt;span class=&quot;hljs-comment&quot;&gt;// j.styleInfo &amp;amp;&amp;amp; delete j.styleInfo;&lt;/span&gt;\n\n            &lt;span class=&quot;hljs-comment&quot;&gt;// 组件事件配置处理&lt;/span&gt;\n            j.events &amp;amp;&amp;amp; j.events.forEach(&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-params&quot;&gt;x&lt;/span&gt; =&amp;gt;&lt;/span&gt; {\n                &lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; midXMap = deepClone(eventMap);\n                &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; k &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; x.configInfo) {\n                    midXMap[k].value = x.configInfo[k];\n                }\n                x.configMap = midXMap;\n                x.configInfo &amp;amp;&amp;amp; &lt;span class=&quot;hljs-keyword&quot;&gt;delete&lt;/span&gt; x.configInfo;\n            });\n        });\n    });\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; activityData;\n}\n\n&lt;span class=&quot;hljs-comment&quot;&gt;/**\n * &lt;span class=&quot;hljs-doctag&quot;&gt;@description &lt;/span&gt;为数据去掉表单项减少数据量，为前端提供更清晰的数据\n * &lt;span class=&quot;hljs-doctag&quot;&gt;@param &lt;span class=&quot;hljs-type&quot;&gt;{*}&lt;/span&gt; &lt;span class=&quot;hljs-variable&quot;&gt;activityData&lt;/span&gt;&lt;/span&gt;\n * &lt;span class=&quot;hljs-doctag&quot;&gt;@returns&lt;/span&gt;\n */&lt;/span&gt;\n&lt;span class=&quot;hljs-keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;hljs-title&quot;&gt;removeConfigMap&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;activityData&lt;/span&gt;) &lt;/span&gt;{\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (!activityData || !activityData.pages || !activityData.pages.length) &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; activityData;\n    activityData.pages.forEach(&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-params&quot;&gt;i&lt;/span&gt; =&amp;gt;&lt;/span&gt; {\n        i.elements.forEach(&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-params&quot;&gt;j&lt;/span&gt; =&amp;gt;&lt;/span&gt; {\n            &lt;span class=&quot;hljs-comment&quot;&gt;// 组件基础配置处理&lt;/span&gt;\n            &lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; midInfo = {};\n            &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; k &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; j.configMap) {\n                midInfo[k] = j.configMap[k].value;\n            }\n            j.configInfo = midInfo;\n            j.configMap &amp;amp;&amp;amp; &lt;span class=&quot;hljs-keyword&quot;&gt;delete&lt;/span&gt; j.configMap;\n\n            &lt;span class=&quot;hljs-comment&quot;&gt;// 组件样式配置处理&lt;/span&gt;\n            &lt;span class=&quot;hljs-comment&quot;&gt;// const styleInfo = {};&lt;/span&gt;\n            &lt;span class=&quot;hljs-comment&quot;&gt;// for (const k in j.styleMap) {&lt;/span&gt;\n            &lt;span class=&quot;hljs-comment&quot;&gt;//     styleInfo[k] = j.styleMap[k].value;&lt;/span&gt;\n            &lt;span class=&quot;hljs-comment&quot;&gt;// }&lt;/span&gt;\n            &lt;span class=&quot;hljs-comment&quot;&gt;// j.styleInfo = styleInfo;&lt;/span&gt;\n            j.styleMap &amp;amp;&amp;amp; &lt;span class=&quot;hljs-keyword&quot;&gt;delete&lt;/span&gt; j.styleMap;\n\n            &lt;span class=&quot;hljs-comment&quot;&gt;// 组件事件配置处理&lt;/span&gt;\n            j.events &amp;amp;&amp;amp; j.events.forEach(&lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-params&quot;&gt;x&lt;/span&gt; =&amp;gt;&lt;/span&gt; {\n                &lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; midXInfo = {};\n                &lt;span class=&quot;hljs-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; k &lt;span class=&quot;hljs-keyword&quot;&gt;in&lt;/span&gt; x.configMap) {\n                    midXInfo[k] = x.configMap[k].value;\n                }\n                x.configInfo = midXInfo;\n                x.configMap &amp;amp;&amp;amp; &lt;span class=&quot;hljs-keyword&quot;&gt;delete&lt;/span&gt; x.configMap;\n            });\n        });\n    });\n    &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt; activityData;\n}\n'"></code></pre>
<h5>快捷键操作</h5>
<blockquote>
<p>全局监听 onkeydown 事件来实现活动保存，组件删除复制粘贴等功能<br>
遇到一个坑的就是，全局监听之后会使输入框本身的复制粘贴等和此处发生混淆错乱，解决方式，自定义指令配合状态标识处理</p>
</blockquote>
<pre class="hljs language language-js" data-lang="js"><code v-html="'&lt;span class=&quot;hljs-built_in&quot;&gt;document&lt;/span&gt;.onkeydown = &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-params&quot;&gt;e&lt;/span&gt; =&amp;gt;&lt;/span&gt; {\n    &lt;span class=&quot;hljs-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.disableKeycode) &lt;span class=&quot;hljs-keyword&quot;&gt;return&lt;/span&gt;;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; hasCtrl = e.metaKey || e.ctrlKey;\n    &lt;span class=&quot;hljs-keyword&quot;&gt;switch&lt;/span&gt; (e.code) {\n        &lt;span class=&quot;hljs-keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;Backspace&quot;&lt;/span&gt;:\n            e.preventDefault();\n            &lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.deleteElement();\n            &lt;span class=&quot;hljs-keyword&quot;&gt;break&lt;/span&gt;;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;KeyS&quot;&lt;/span&gt;:\n            e.preventDefault();\n            hasCtrl &amp;amp;&amp;amp; &lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.$emit(&lt;span class=&quot;hljs-string&quot;&gt;&quot;saveActivity&quot;&lt;/span&gt;);\n            &lt;span class=&quot;hljs-keyword&quot;&gt;break&lt;/span&gt;;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;KeyC&quot;&lt;/span&gt;:\n            e.preventDefault();\n            hasCtrl &amp;amp;&amp;amp; &lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.copyElement();\n            &lt;span class=&quot;hljs-keyword&quot;&gt;break&lt;/span&gt;;\n        &lt;span class=&quot;hljs-keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;hljs-string&quot;&gt;&quot;KeyV&quot;&lt;/span&gt;:\n            e.preventDefault();\n            hasCtrl &amp;amp;&amp;amp; &lt;span class=&quot;hljs-keyword&quot;&gt;this&lt;/span&gt;.pasteElement();\n            &lt;span class=&quot;hljs-keyword&quot;&gt;break&lt;/span&gt;;\n    }\n};\n\nVue.directive(&lt;span class=&quot;hljs-string&quot;&gt;&quot;setDisableKeycode&quot;&lt;/span&gt;, {\n    &lt;span class=&quot;hljs-attr&quot;&gt;inserted&lt;/span&gt;: &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-keyword&quot;&gt;function&lt;/span&gt;(&lt;span class=&quot;hljs-params&quot;&gt;elPar&lt;/span&gt;) &lt;/span&gt;{\n        &lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; elInput = elPar.getElementsByTagName(&lt;span class=&quot;hljs-string&quot;&gt;&quot;input&quot;&lt;/span&gt;) &amp;amp;&amp;amp; elPar.getElementsByTagName(&lt;span class=&quot;hljs-string&quot;&gt;&quot;input&quot;&lt;/span&gt;)[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;];\n        &lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; elTextarea = elPar.getElementsByTagName(&lt;span class=&quot;hljs-string&quot;&gt;&quot;textarea&quot;&lt;/span&gt;) &amp;amp;&amp;amp; elPar.getElementsByTagName(&lt;span class=&quot;hljs-string&quot;&gt;&quot;textarea&quot;&lt;/span&gt;)[&lt;span class=&quot;hljs-number&quot;&gt;0&lt;/span&gt;];\n        &lt;span class=&quot;hljs-keyword&quot;&gt;const&lt;/span&gt; el = elInput || elTextarea;\n        el.onfocus = &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; =&amp;gt;&lt;/span&gt; {\n            store.dispatch(&lt;span class=&quot;hljs-string&quot;&gt;&quot;setDisableKeycode&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-literal&quot;&gt;true&lt;/span&gt;);\n        };\n        el.onblur = &lt;span class=&quot;hljs-function&quot;&gt;&lt;span class=&quot;hljs-params&quot;&gt;()&lt;/span&gt; =&amp;gt;&lt;/span&gt; {\n            store.dispatch(&lt;span class=&quot;hljs-string&quot;&gt;&quot;setDisableKeycode&quot;&lt;/span&gt;, &lt;span class=&quot;hljs-literal&quot;&gt;false&lt;/span&gt;);\n        };\n    }\n});\n'"></code></pre>
</div>
</div>
</template>

<script>
/** eslint-disable **/

export default {
    components: {

    },
    mixins: [

    ]
};
</script>
